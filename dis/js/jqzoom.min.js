!function(x){x.fn.zoom=function(t){var o={align:"left",thumb_image_width:300,thumb_image_height:400,source_image_width:900,source_image_height:1200,zoom_area_width:600,zoom_area_height:"justify",zoom_area_distance:10,zoom_easing:!0,click_to_zoom:!1,zoom_element:"auto",show_descriptions:!0,description_location:"bottom",description_opacity:.7,small_thumbs:3,smallthumb_inactive_opacity:.4,smallthumb_hide_single:!0,smallthumb_select_on_hover:!1,smallthumbs_position:"bottom",show_icon:!0,hide_cursor:!1,speed:600,autoplay:!0,autoplay_interval:6e3,keyboard:!0,right_to_left:!1};t&&x.extend(o,t);var g=x(this);if(g.is("ul")&&g.children("li").length&&g.find(".etalage_big_image").length){g.addClass("etalage clearfix").show();var e=g.children("li").addClass("etalage_thumb"),a=e.length,i=o.autoplay;e.first().addClass("etalage_thumb_active").show(),a<2&&(i=!1),g.find(".etalage_thumb_image").css({width:o.thumb_image_width,height:o.thumb_image_height}).show();var u,c,s,n,d=o.thumb_image_width/o.source_image_width,r=o.thumb_image_height/o.source_image_height,h=o.thumb_image_width/o.thumb_image_height;if(x(".etalage_magnifier").length||(u=x('<li class="etalage_magnifier"><div class=""><img src="" /></div></li>'),c=u.find("img"),g.append(u),u.css({top:m,left:_}),c.attr("src",g.find(".etalage_thumb_active .etalage_thumb_image").attr("src")).css({width:o.thumb_image_width,height:o.thumb_image_height}),u.find("div").css({width:o.thumb_image_width*d,height:o.thumb_image_height*r})),!x(".etalage_zoom_area").length){s=x('<li class="etalage_zoom_area"><div><img class="etalage_zoom_img" /></div></li>'),n=s.find(".etalage_zoom_img");var m=0,_=0;g.append(s),"left"==o.align&&(_=(m=0)+o.thumb_image_width+o.zoom_area_distance),s.css({top:m,left:_}),n.css({width:o.source_image_width,height:o.source_image_height})}var l={autotime:null,isplay:i,start:function(){this.isplay&&!this.autotime&&(this.autotime=setInterval(function(){z((g.find(".etalage_thumb_active").index()+1)%o.small_thumbs)},o.autoplay_interval))},stop:function(){clearInterval(this.autotime),this.autotime=null},restart:function(){this.stop(),this.start()}},p="";if(!x(".etalage_small_thumbs").length){m=o.thumb_image_height+10;for(var b=o.thumb_image_width,f=o.thumb_image_width/o.small_thumbs-10,v=f/h,w=(smurl="",""),y=0;y<o.small_thumbs;y++)smurl=e.eq(y).find(".etalage_thumb_image").attr("src"),w+=0==y?'<li class="etalage_smallthumb_active"><img src="'+smurl+'" alt="small" style="width:'+f+"px; height:"+v+'px;" /></li>':'<li style="opacity:0.4;"><img src="'+smurl+'" alt="small" style="width:'+f+"px; height:"+v+'px;" /></li>';p=x('<li class="etalage_small_thumbs" style="top:'+m+"px; width:"+b+'px;"><ul class="clearfix" style="width: 485px;">'+w+"</ul></li>"),g.append(p),p.delegate("li","click",function(t){z(x(this).index()),l.restart()}),l.start()}function z(t){g.find(".etalage_thumb_active").removeClass("etalage_thumb_active").stop().animate({opacity:0},o.speed,function(){x(this).hide()}),p.find(".etalage_smallthumb_active").removeClass("etalage_smallthumb_active").stop().animate({opacity:o.smallthumb_inactive_opacity},o.speed),e.eq(t).addClass("etalage_thumb_active").show().stop().css({opacity:0}).animate({opacity:1},o.speed),p.find("li:eq("+t+")").addClass("etalage_smallthumb_active").show().stop().css({opacity:o.smallthumb_inactive_opacity}).animate({opacity:1},o.speed),c.attr("src",e.eq(t).find(".etalage_thumb_image").attr("src"))}o.zoom_area_height=o.zoom_area_width/h,s.find("div").css({width:o.zoom_area_width,height:o.zoom_area_height}),e.add(u).mousemove(function(t){var e,a,i=t.pageX-g.offset().left,s=t.pageY-g.offset().top,h=o.thumb_image_width*d,m=o.thumb_image_height*d,_=0,l=0;_=i<o.thumb_image_width/2?h/2<i?i-h/2:0:i+h/2>o.thumb_image_width?o.thumb_image_width-h:i-h/2,l=s<o.thumb_image_height/2?m/2<s?s-m/2:0:s+m/2>o.thumb_image_height?o.thumb_image_height-m:s-m/2,e=_/d,a=l/r,u.css({left:_,top:l}),c.css({left:-_,top:-l}),n.css({left:-e,top:-a})}).mouseenter(function(t){l.stop(),n.attr("src",x(this).find(".etalage_big_image").attr("src")),s.css({"background-image":"none"}).stop().fadeIn(400),g.find(".etalage_thumb_active").stop().animate({opacity:.5},.7*o.speed),u.stop().animate({opacity:1},.7*o.speed).show()}).mouseleave(function(t){s.stop().fadeOut(400),g.find(".etalage_thumb_active").stop().animate({opacity:1},.7*o.speed),u.stop().animate({opacity:0},.7*o.speed,function(){x(this).hide()}),l.start()})}}}(jQuery);